Deploy Status:
<img src="https://github.com/vovk-wan/channel_admin/workflows/channel_admin/badge.svg?branch=develop"><br>

Authors: Deskent && Vovk-van



# channel_admin
Бот - админ канала в телеграм
Канал создается для учеников - пользователей платформы https://getcourse.ru/

Бот должен уметь:

  1) Генерировать и отсылать пользователю короткоживущую ссылку-приглашение в канал.
    для этого на запрос пользователем ссылки проверять информацию о платеже (вопрос там есть ограничение запросов, возможно посылать отмазку и планировать чела в проверку)
    и если ползователь имеет доступ к ресурсу указанному заказчиком,
      разбанивать в канале (если забанен),
      генерировать и отправлять ссылку пользователю,
      обновлять информацию в базе данных.

   2) Удалять пользователей с канала (у кого истекла подписка на https://getcourse.ru/)
    для этого периодически обновлять информацию о пользователях с истекшей подпиской на ресурсе,

PS
  по требованиям заказчика всё, но возможно придется сделать хоть минимальное управление но тут будет зависить от доплаты

  еще технический вопрос про ид канала если канал не один планируется, лучше предусмотреть при проектировании бд


Инструкция:

1. Создать канал в телеграмме, добавить туда бота и дать ему админские права.
2. Ввести команду /channel и скопировать туда ссылку на любое сообщение канала
"Канал изменен."
3. Ввести команду /group и выбрать нужную группу из списка. Если список пустой нужно подождать, пока бот обновит данные с АПИ сервиса.


Настройка получения мемберов канала:

1. Идем на https://my.telegram.org/
Вводим свой номер телефона и далее вводим код подтверждения, который придет в телеграм.
2. Заполняем поля и создаем приложение.
3. Нам нужны два параметра: App api_id и App api_hash.
Копируем их значения в файл .env в соответствующие переменные.
4. В рабочем каталоге должны находится файлы:
.env
get_session.py
и папки db и logs
Переходим в рабочий каталог и выполняем команду:
exec python3 -m venv env && source ./env/bin/activate && python3 -m pip install -U pip && pip install telethon python-dotenv && python get_session.py

Он попросит ввести токен - нужно ввести токен бота, который находится в канале.
5. Перезапустить бота (контейнер)


Доступ на сервер пользователям:
sudo vim /etc/ssh/sshd_config
AllowUsers root deskent      <- здесь перечислить кому дать доступ по shh

sudo service ssh restart
